{
  "hash": "c96c44739526b6c0c8f5164a6d7ca763",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Regressão Linear Bayesiana - Implementação Prática\"\nsubtitle: \"Lista de Exercícios 3\"\nexecute:\n  echo: true\n  warning: false\n  include: true\n  message: false\n---\n\n\n\n\n---\n\n**ENTREGA**: *até 26/06/2025 às 23:59, via Moodle*\n\n::: {.callout-important title=\"Dicas Importantes\"}\n\n\n- Entregue seu código em um arquivo do **google Colab** `. ipynb`\n- Documente seu código com comentários claros\n- Justifique suas escolhas metodológicas\n- Responda cada questão e mantenha os código utilizados para gerar os gráficos\n\n:::\n\n---\n\n## Objetivos\n\nEsta lista visa desenvolver suas habilidades práticas na implementação de modelos de regressão linear bayesiana utilizando a biblioteca `bambi` em Python. Você irá aprender a:\n\n- Especificar e ajustar modelos bayesianos do zero\n- Definir distribuições a priori apropriadas\n- Realizar diagnósticos de convergência MCMC\n- Interpretar resultados bayesianos no contexto de incerteza paramétrica\n- Visualizar e comunicar resultados de análises bayesianas\n\n## Contexto\n\nEm estudos ecológicos, investigamos como variáveis ambientais influenciam a biodiversidade. Nesta lista, analisaremos dados de praias na costa holandesa, examinando a relação entre:\n\n- **Riqueza de espécies** (`Richness`): número de espécies diferentes por local (variável resposta)\n- **NAP** (*Normaal Amsterdams Peil*): altura do local em relação ao nível médio do mar (variável preditora)\n\nOs dados provêm do estudo descrito no Capítulo 5 de Zuur et al. (2009) e estão disponíveis no arquivo [RIKZ.csv](https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/RIKZ.csv){target=\"_blank\"}.\n\n---\n\n## EXERCÍCIOS{-}\n\n**1.  Preparação e Exploração Inicial dos Dados**\n\n**1.1** Abra um novo arquivo no **Google Colab**\n\n**1.2** Carregue as bibliotecas necessárias e importe o conjunto de dados `RIKZ.csv` do link:\n[https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/RIKZ.csv](https://raw.githubusercontent.com/FCopf/datasets/refs/heads/main/RIKZ.csv){target=\"_blank\"}\n\n::: {.callout-note}\n*Bibliotecas sugeridas: pandas, bambi, arviz, numpy, matplotlib.pyplot, seaborn*. \n\nNo Google Colab, as bibliotecas bambi e arviz deverão ser instaladas a cada nova seção rodando o comando abaixo, que deve ser inserido na primeira cálula do arquivo.\n\n::: {#a97f781a .cell execution_count=1}\n``` {.python .cell-code}\n!pip install bambi arviz\n```\n:::\n\n\n::: {#88a714c5 .cell execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nimport bambi as bmb\nimport arviz as az\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n:::\n\n\n:::\n\n\n**1. Análise Exploratória**\n\n**1.1** Crie um gráfico de dispersão entre `Richness` (eixo y) e `NAP` (eixo x) para verificar visualmente se há uma relação linear entre essas variáveis.\n\n<span style=\"color: red;\">**Questão 1**</span>: A relação entre riqueza de espécies e NAP parece ser aproximadamente linear? Caso não seja, explique.\n\n---\n\n**2. Especificação do Modelo Bayesiano**\n\n**2.1** Especifique um modelo de regressão linear bayesiano usando a bilbioteca `bambi` do Python:\n\n- Utilize a sintaxe de fórmula: `Richness ~ NAP`\n- Examine a estrutura do modelo criado\n\n**2.2** Distribuições a priori padrão:\n\n- Não especifique as distribuições a priori e utilize as atribuições padrão da biblioteca.\n- Identifique quais prioris foram atribuídas para o intercepto, coeficiente de NAP e sigma\n- Avalie as curvas de densidade das distribuições apriori\n\n<span style=\"color: red;\">**Questão 2a**</span>: Qual família de distribuição (`Family`) e função de ligação (`Link`) foram utilizadas?\n\n<span style=\"color: red;\">**Questão 2b**</span>: Quais prioris foram, atribuídas ao intercepto, ao coeficiente de NAP e a sigma? \n\n<span style=\"color: red;\">**Questão 2c**</span>: Considerando as priori como \"crenças iniciais\" do modelo antes de observar os dados, os limites escolhidos automaticamente parecem muito ou pouco informativos? Justifique.\n\n---\n\n**3. Ajuste do Modelo via MCMC**\n\n**3.1** Realize a amostragem MCMC para obter a distribuição a posteriori e gere a tabela resumo:\n\n- Foque nos parâmetros principais: intercepto, coeficiente de NAP e sigma\n\n<span style=\"color: red;\">**Questão 3a**</span>: Quais foram as médias, desvios padrões (`sd`) para cada parâmetro?\n\n<span style=\"color: red;\">**Questão 3b**</span>: Quais foram os limites dos intervalos de credibilidade para cada parâmetro?\n\n---\n\n**4. Interpretação dos Resultados Bayesianos**\n\n**4.1** Com base na estimativa pontual (média a posteriori) do coeficiente de NAP e no intervalo de credibilidade HDI de 94%, responda:\n\n<span style=\"color: red;\">**Questão 4a**</span>: O que você conclui sobre a existência e direção do efeito linear de NAP sobre a riqueza de espécies?\n\n<span style=\"color: red;\">**Questão 4b**</span>: Como você interpreta o valor da estimativa pontual do coeficiente de NAP em termos práticos?\n\n<span style=\"color: red;\">**Questão 4b**</span>: O que o intervalo de credibilidade HDI de 94% nos informa sobre a incerteza dessa estimativa?\n\n---\n\n**6. Visualização da Incerteza Preditiva**\n\n**6.1** Visualize a incerteza na reta de regressão:\n\n- Plote múltiplas retas possíveis amostradas da distribuição a posteriori\n- Inclua os dados observados no gráfico\n- Adicione a reta média da posteriori\n\n**6.2** Calcule e visualize o intervalo de credibilidade da reta média:\n\n- Calcule intervalos de credibilidade de 95% para a reta média\n- Crie um gráfico com a banda de credibilidade\n\n<span style=\"color: red;\">**Questão 6a**</span>: Onde a variabilidade das retas da posteriori é maior - no centro dos dados ou nos extremos? Por que isso é esperado estatisticamente?\n\n<span style=\"color: red;\">**Questão 6b**</span>: Como você interpretaria o intervalo de credibilidade da reta média para um colega que não tem formação em estatística bayesiana?\n\n---\n\n**7. Predições para Novos Dados**\n\n**7.1** Faça predições bayesianas para novos valores de NAP:\n\n- Escolha novos os valores de `NAP` como `[-1.3, 0, 3]`\n- Obtenha distribuições preditivas da riqueza para estes limites de `NAP`\n- Visualize histogramas dessas distribuições\n\n<span style=\"color: red;\">**Questão 7**</span>: Analise criticamente os valores preditos de riqueza de espécies:\n\n1. **Plausibilidade biológica**: Os valores preditos fazem sentido biologicamente? Por quê?\n\n2. **Comparação com dados observados**: Como as predições se comparam com o padrão e a faixa de valores observados nos dados originais?\n\n3. **Limitações do modelo**: O que essas predições revelam sobre as limitações do modelo linear ajustado? Em que situações o modelo pode fornecer predições inadequadas?\n\n4. **Extrapolação**: Quais cuidados devemos ter ao usar este modelo para fazer predições, especialmente em valores extremos de `NAP`?\n\n---\n\n",
    "supporting": [
      "lista-exercicios-3_files"
    ],
    "filters": [],
    "includes": {}
  }
}